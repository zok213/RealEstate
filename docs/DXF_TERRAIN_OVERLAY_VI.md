# TÃ­nh nÄƒng Hiá»ƒn thá»‹ Äá»‹a hÃ¬nh Thá»±c táº¿ tá»« DXF/DWG

## Tá»•ng quan

TÃ­nh nÄƒng nÃ y cho phÃ©p **thiáº¿t káº¿ khu cÃ´ng nghiá»‡p thÃ´ng minh** báº±ng cÃ¡ch:
1. Hiá»ƒn thá»‹ file DXF/DWG trá»±c tiáº¿p trÃªn báº£n Ä‘á»“ Mapbox vá»›i áº£nh vá»‡ tinh vÃ  Ä‘á»‹a hÃ¬nh thá»±c táº¿
2. Tá»± Ä‘á»™ng phÃ¡t hiá»‡n cÃ¡c Ä‘á»‘i tÆ°á»£ng hiá»‡n cÃ³ (há»“ nÆ°á»›c, tÃ²a nhÃ , Ä‘Æ°á»ng, cÃ¢y cá»‘i)
3. PhÃ¢n loáº¡i Ä‘á»‘i tÆ°á»£ng nÃ o cÃ³ thá»ƒ tÃ¡i sá»­ dá»¥ng, Ä‘á»‘i tÆ°á»£ng nÃ o cáº§n phÃ¡ dá»¡
4. TÃ­ch há»£p vÃ o thuáº­t toÃ¡n thiáº¿t káº¿ Ä‘á»ƒ táº­n dá»¥ng cÆ¡ sá»Ÿ háº¡ táº§ng hiá»‡n cÃ³ thay vÃ¬ xÃ¢y má»›i

## Váº¥n Ä‘á» Ä‘Æ°á»£c giáº£i quyáº¿t

**TrÆ°á»›c Ä‘Ã¢y**: Há»‡ thá»‘ng coi má»i khu Ä‘áº¥t nhÆ° Ä‘áº¥t trá»‘ng, thiáº¿t káº¿ tá»« Ä‘áº§u, bá» qua:
- Há»“ nÆ°á»›c hiá»‡n cÃ³ (tá»‘n 500K-1M THB Ä‘á»ƒ láº¥p)
- ÄÆ°á»ng Ä‘Ã£ cÃ³ (tá»‘n hÃ ng triá»‡u Ä‘á»ƒ xÃ¢y láº¡i)
- TÃ²a nhÃ  cÃ²n tá»‘t (phÃ¡ + xÃ¢y láº¡i ráº¥t tá»‘n kÃ©m)
- CÃ¢y cá»‘i lá»›n (vi pháº¡m quy Ä‘á»‹nh mÃ´i trÆ°á»ng)

**Giá» Ä‘Ã¢y**: Há»‡ thá»‘ng hiá»ƒu Ä‘á»‹a hÃ¬nh thá»±c táº¿, táº­n dá»¥ng nhá»¯ng gÃ¬ cÃ³ sáºµn, tiáº¿t kiá»‡m chi phÃ­ vÃ  thá»i gian.

## Quy trÃ¬nh sá»­ dá»¥ng

### BÆ°á»›c 1: Táº£i file DXF/DWG

1. Má»Ÿ giao diá»‡n thiáº¿t káº¿
2. Nháº¥n "Upload DXF/DWG File"
3. Chá»n file báº£n váº½ hiá»‡n tráº¡ng (tá»« CAD)

Há»‡ thá»‘ng sáº½:
- Tá»± Ä‘á»™ng chuyá»ƒn Ä‘á»•i tá»a Ä‘á»™ DXF sang tá»a Ä‘á»™ Ä‘á»‹a lÃ½ (lat/lng)
- Hiá»ƒn thá»‹ trÃªn báº£n Ä‘á»“ Mapbox vá»›i áº£nh vá»‡ tinh
- PhÃ¡t hiá»‡n cÃ¡c Ä‘á»‘i tÆ°á»£ng hiá»‡n cÃ³

### BÆ°á»›c 2: XÃ¡c Ä‘á»‹nh vá»‹ trÃ­ (náº¿u cáº§n)

Náº¿u file DXF khÃ´ng cÃ³ thÃ´ng tin tá»a Ä‘á»™, há»‡ thá»‘ng yÃªu cáº§u báº¡n:
1. Nháº¥n 3 Ä‘iá»ƒm trÃªn báº£n váº½ DXF
2. Nháº¥n 3 Ä‘iá»ƒm tÆ°Æ¡ng á»©ng trÃªn báº£n Ä‘á»“ Mapbox
3. Há»‡ thá»‘ng tá»± Ä‘á»™ng tÃ­nh toÃ¡n chuyá»ƒn Ä‘á»•i tá»a Ä‘á»™

**VÃ­ dá»¥**:
- GÃ³c A trÃªn DXF (100, 200) â†’ Lat/Lng trÃªn báº£n Ä‘á»“ (100.5000Â°, 13.7500Â°)
- GÃ³c B trÃªn DXF (500, 200) â†’ Lat/Lng trÃªn báº£n Ä‘á»“ (100.5200Â°, 13.7500Â°)
- GÃ³c C trÃªn DXF (300, 600) â†’ Lat/Lng trÃªn báº£n Ä‘á»“ (100.5100Â°, 13.7700Â°)

### BÆ°á»›c 3: Xem Ä‘á»‹a hÃ¬nh thá»±c táº¿

Sau khi táº£i lÃªn, báº¡n sáº½ tháº¥y:
- **HÃ¬nh dáº¡ng khu Ä‘áº¥t** chá»“ng lÃªn áº£nh vá»‡ tinh thá»±c táº¿
- **CÃ¡c Ä‘á»‘i tÆ°á»£ng phÃ¡t hiá»‡n** Ä‘Æ°á»£c tÃ´ mÃ u:
  - ğŸ”µ **MÃ u xanh dÆ°Æ¡ng**: Há»“ nÆ°á»›c, ao
  - ğŸ”¶ **MÃ u xÃ¡m**: TÃ²a nhÃ  hiá»‡n cÃ³
  - ğŸŸ¡ **MÃ u vÃ ng**: ÄÆ°á»ng hiá»‡n cÃ³
  - ğŸŸ¢ **MÃ u xanh lÃ¡**: CÃ¢y cá»‘i, thæ¤váº­t
  - â­• **ÄÆ°á»ng viá»n tráº¯ng**: Ranh giá»›i khu Ä‘áº¥t

### BÆ°á»›c 4: Kiá»ƒm tra phÃ¢n tÃ­ch tá»± Ä‘á»™ng

Há»‡ thá»‘ng tá»± Ä‘á»™ng phÃ¢n tÃ­ch vÃ  Ä‘á» xuáº¥t:

#### ğŸŸ¢ Giá»¯ nguyÃªn (Keep as-is)
- Há»“ nÆ°á»›c lá»›n >5000 mÂ² (>3 rai)
  - LÃ½ do: Tá»‘n 500K-1M THB Ä‘á»ƒ láº¥p
  - Táº¡o vÃ¹ng cáº¥m xÃ¢y 20m xung quanh
- CÃ¢y cá»‘i lá»›n bÃ¡n kÃ­nh >5m
  - LÃ½ do: Báº£o vá»‡ mÃ´i trÆ°á»ng
  - Táº¡o vÃ¹ng báº£o vá»‡ 15m

#### ğŸŸ¡ TÃ¡i sá»­ dá»¥ng/Cáº£i táº¡o (Reuse/Modify)
- TÃ²a nhÃ  lá»›n >2000 mÂ² (>1.25 rai)
  - Chi phÃ­ sá»­a chá»¯a: 3,000 THB/mÂ²
  - Ráº» hÆ¡n phÃ¡ + xÃ¢y má»›i: 6,500 THB/mÂ²
  - CÃ³ thá»ƒ dÃ¹ng lÃ m vÄƒn phÃ²ng quáº£n lÃ½
- Há»“ nhá» <5000 mÂ²
  - CÃ³ thá»ƒ má»Ÿ rá»™ng thÃ nh bá»ƒ chá»©a nÆ°á»›c
- ÄÆ°á»ng dÃ i >100m
  - CÃ³ thá»ƒ nÃ¢ng cáº¥p, má»Ÿ rá»™ng
  - Tiáº¿t kiá»‡m chi phÃ­ xÃ¢y dá»±ng má»›i

#### ğŸ”´ PhÃ¡ dá»¡ (Demolish)
- TÃ²a nhÃ  nhá» <2000 mÂ²
  - Chi phÃ­ phÃ¡ dá»¡ tháº¥p
  - KhÃ´ng Ä‘Ã¡ng Ä‘á»ƒ giá»¯ láº¡i

### BÆ°á»›c 5: Äiá»u chá»‰nh phÃ¢n loáº¡i (tÃ¹y chá»n)

Báº¡n cÃ³ thá»ƒ thay Ä‘á»•i quyáº¿t Ä‘á»‹nh cá»§a há»‡ thá»‘ng:

**VÃ­ dá»¥**:
- Há»“ nÆ°á»›c nhá»: Há»‡ thá»‘ng Ä‘á» xuáº¥t "TÃ¡i sá»­ dá»¥ng"
  - Báº¡n muá»‘n giá»¯ nguyÃªn â†’ Nháº¥n "Keep" â†’ VÃ¹ng cáº¥m xÃ¢y 20m
- TÃ²a nhÃ  lá»›n: Há»‡ thá»‘ng Ä‘á» xuáº¥t "TÃ¡i sá»­ dá»¥ng"
  - Báº¡n muá»‘n phÃ¡ dá»¡ â†’ Nháº¥n "Demolish" â†’ Khu vá»±c trá»‘ng

**Chi phÃ­ Æ°á»›c tÃ­nh**:
- Má»—i Ä‘á»‘i tÆ°á»£ng hiá»ƒn thá»‹ chi phÃ­:
  - âœ… Giá»¯ nguyÃªn: à¸¿0
  - ğŸ”§ Sá»­a chá»¯a: à¸¿XXX,XXX
  - âŒ PhÃ¡ dá»¡ + xÃ¢y má»›i: à¸¿XXX,XXX

### BÆ°á»›c 6: Táº¡o thiáº¿t káº¿ thÃ´ng minh

Nháº¥n "Generate Context-Aware Design" - Há»‡ thá»‘ng sáº½:

1. **TrÃ¡nh vÃ¹ng cáº¥m xÃ¢y**:
   - KhÃ´ng xÃ¢y lÃ´ Ä‘áº¥t gáº§n há»“ nÆ°á»›c giá»¯ láº¡i
   - TrÃ¡nh cÃ¢y cá»‘i Ä‘Æ°á»£c báº£o vá»‡

2. **Táº­n dá»¥ng cÆ¡ sá»Ÿ háº¡ táº§ng**:
   - ÄÆ°á»ng má»›i ná»‘i vá»›i Ä‘Æ°á»ng cÅ© (thay vÃ¬ xÃ¢y hoÃ n toÃ n má»›i)
   - Má»Ÿ rá»™ng há»“ nhá» thÃ nh bá»ƒ chá»©a nÆ°á»›c (thay vÃ¬ Ä‘Ã o má»›i)

3. **Chuyá»ƒn Ä‘á»•i tÃ²a nhÃ **:
   - TÃ²a nhÃ  vuÃ´ng lá»›n â†’ VÄƒn phÃ²ng quáº£n lÃ½
   - TÃ²a nhÃ  nhá» â†’ PhÃ¡ dá»¡, xÃ¢y lÃ´ cÃ´ng nghiá»‡p

## VÃ­ dá»¥ thá»±c táº¿

### Khu cÃ´ng nghiá»‡p 50 rai (80,000 mÂ²)

**PhÃ¡t hiá»‡n Ä‘Æ°á»£c**:
- 3 há»“ nÆ°á»›c lá»›n (tá»•ng 15,000 mÂ²)
- 1 Ä‘Æ°á»ng nhá»±a dÃ i 500m
- 2 tÃ²a nhÃ  lá»›n (4,000 mÂ²)
- 5 cÃ¢y cá»• thá»¥

**Quyáº¿t Ä‘á»‹nh**:
- âœ… Giá»¯ 3 há»“ nÆ°á»›c + 5 cÃ¢y cá»• thá»¥
- ğŸ”§ Táº­n dá»¥ng Ä‘Æ°á»ng cÅ©, nÃ¢ng cáº¥p
- ğŸ”§ Sá»­a 2 tÃ²a nhÃ  lÃ m vÄƒn phÃ²ng

**Tiáº¿t kiá»‡m**:
1. **Há»“ nÆ°á»›c**: 15,000 mÂ² Ã— 100 THB/mÂ² = **1.5 triá»‡u THB**
2. **ÄÆ°á»ng**: 500m Ã— 12m Ã— 800 THB/mÂ² = **4.8 triá»‡u THB**
3. **TÃ²a nhÃ **: (PhÃ¡+xÃ¢y: 26M) - (Sá»­a: 12M) = **14 triá»‡u THB**
4. **CÃ¢y cá»‘i**: TrÃ¡nh pháº¡t vi pháº¡m mÃ´i trÆ°á»ng = **VÃ´ giÃ¡**

**Tá»•ng tiáº¿t kiá»‡m: ~20 triá»‡u THB (~$570K USD)**

## Lá»£i Ã­ch

### ğŸ’° Chi phÃ­
- Tiáº¿t kiá»‡m 10-20% chi phÃ­ xÃ¢y dá»±ng
- TrÃ¡nh chi phÃ­ láº¥p há»“ (ráº¥t tá»‘n kÃ©m)
- Giáº£m chi phÃ­ phÃ¡ dá»¡ khÃ´ng cáº§n thiáº¿t

### â±ï¸ Thá»i gian
- Nhanh hÆ¡n 2-3 thÃ¡ng (khÃ´ng cáº§n láº¥p há»“, phÃ¡ dá»¡)
- Dá»… dÃ ng xin phÃ©p mÃ´i trÆ°á»ng (giá»¯ há»“ nÆ°á»›c, cÃ¢y cá»‘i)

### ğŸŒ¿ MÃ´i trÆ°á»ng
- Báº£o vá»‡ nguá»“n nÆ°á»›c tá»± nhiÃªn
- Giá»¯ cÃ¢y cá»‘i trÆ°á»Ÿng thÃ nh
- Giáº£m rÃ¡c tháº£i xÃ¢y dá»±ng

### ğŸ† Cáº¡nh tranh
- KhÃ¡ch hÃ ng hÃ i lÃ²ng (tÃ´n trá»ng Ä‘á»‹a hÃ¬nh hiá»‡n cÃ³)
- Thiáº¿t káº¿ "thÃ´ng minh" hÆ¡n Ä‘á»‘i thá»§
- GiÃ¡ thÃ nh cáº¡nh tranh hÆ¡n

## CÃ´ng nghá»‡

### Chuyá»ƒn Ä‘á»•i tá»a Ä‘á»™
- **Affine Transformation**: Chuyá»ƒn Ä‘á»•i tá»a Ä‘á»™ DXF (x, y) â†’ Lat/Lng
- **Ma tráº­n 3Ã—3**: Rotation + Scale + Translation
- **Äá»™ chÃ­nh xÃ¡c**: RMSE <10m (cháº¥p nháº­n Ä‘Æ°á»£c)

### PhÃ¡t hiá»‡n Ä‘á»‘i tÆ°á»£ng
- **Layer-based detection**: TÃ¬m theo tÃªn layer (WATER, POND, HO, NUOC, à¸—à¸²à¸‡à¸™à¹‰à¸³)
- **HÃ¬nh há»c**: Polyline kÃ­n = há»“/tÃ²a nhÃ , Polyline má»Ÿ = Ä‘Æ°á»ng
- **Äa ngÃ´n ngá»¯**: Há»— trá»£ tiáº¿ng Anh, Viá»‡t, ThÃ¡i

### Hiá»ƒn thá»‹ báº£n Ä‘á»“
- **Mapbox GL JS**: Hiá»ƒn thá»‹ áº£nh vá»‡ tinh cháº¥t lÆ°á»£ng cao
- **GeoJSON**: Format chuáº©n cho web mapping
- **Layer toggles**: Báº­t/táº¯t tá»«ng loáº¡i Ä‘á»‘i tÆ°á»£ng

## Cáº¥u hÃ¬nh

### Token Mapbox
Táº¡o file `.env.local`:
```
NEXT_PUBLIC_MAPBOX_TOKEN=pk.your_token_here
```

### NgÆ°á»¡ng tÃ¹y chá»‰nh
CÃ³ thá»ƒ Ä‘iá»u chá»‰nh trong code:
```python
WATER_KEEP_THRESHOLD = 5000  # mÂ² - Há»“ >5000mÂ² giá»¯ láº¡i
BUILDING_REUSE_THRESHOLD = 2000  # mÂ² - NhÃ  >2000mÂ² tÃ¡i sá»­ dá»¥ng
ROAD_REUSE_THRESHOLD = 100  # m - ÄÆ°á»ng >100m táº­n dá»¥ng
```

## CÃ¢u há»i thÆ°á»ng gáº·p

### Q: File DXF cá»§a tÃ´i khÃ´ng cÃ³ tá»a Ä‘á»™?
A: Chá»n 3 Ä‘iá»ƒm trÃªn báº£n váº½, sau Ä‘Ã³ 3 Ä‘iá»ƒm tÆ°Æ¡ng á»©ng trÃªn báº£n Ä‘á»“. Há»‡ thá»‘ng tá»± tÃ­nh.

### Q: Há»‡ thá»‘ng khÃ´ng phÃ¡t hiá»‡n há»“ nÆ°á»›c?
A: Kiá»ƒm tra:
- Layer cÃ³ tÃªn WATER, POND, HO, NUOC khÃ´ng?
- Há»“ cÃ³ pháº£i polyline kÃ­n khÃ´ng?
- KÃ­ch thÆ°á»›c há»“ Ä‘á»§ lá»›n khÃ´ng? (>100 mÂ²)

### Q: TÃ´i muá»‘n giá»¯ há»“ nhá» thay vÃ¬ má»Ÿ rá»™ng?
A: VÃ o "Reusable Features Manager", tÃ¬m há»“ Ä‘Ã³, nháº¥n "Keep" thay vÃ¬ "Reuse".

### Q: Chi phÃ­ Æ°á»›c tÃ­nh cÃ³ chÃ­nh xÃ¡c khÃ´ng?
A: ÄÃ¢y lÃ  Æ°á»›c tÃ­nh sÆ¡ bá»™ dá»±a trÃªn:
- Láº¥p há»“: 100 THB/mÂ²
- XÃ¢y Ä‘Æ°á»ng: 800 THB/mÂ²/m
- Sá»­a nhÃ : 3,000 THB/mÂ²
- PhÃ¡ dá»¡: 1,500 THB/mÂ²

Chi phÃ­ thá»±c táº¿ phá»¥ thuá»™c Ä‘á»‹a Ä‘iá»ƒm, thá»i Ä‘iá»ƒm.

### Q: TÃ´i cÃ³ thá»ƒ xuáº¥t báº£n Ä‘á»“ khÃ´ng?
A: CÃ³, nháº¥n nÃºt Export â†’ Chá»n Ä‘á»‹nh dáº¡ng (PNG, PDF, GeoJSON)

## Há»— trá»£

### Lá»—i táº£i file
- Kiá»ƒm tra file .dxf hoáº·c .dwg
- KÃ­ch thÆ°á»›c file <50MB
- File khÃ´ng bá»‹ há»ng

### Báº£n Ä‘á»“ khÃ´ng hiá»ƒn thá»‹
- Kiá»ƒm tra token Mapbox
- Kiá»ƒm tra káº¿t ná»‘i internet
- XÃ³a cache trÃ¬nh duyá»‡t

### Äá»‘i tÆ°á»£ng phÃ¡t hiá»‡n sai
- Kiá»ƒm tra tÃªn layer trong DXF
- Sá»­ dá»¥ng DWG Viewer Ä‘á»ƒ xem cáº¥u trÃºc file
- Gá»­i file máº«u cho Ä‘á»™i phÃ¡t triá»ƒn

## Káº¿t luáº­n

TÃ­nh nÄƒng nÃ y biáº¿n thiáº¿t káº¿ khu cÃ´ng nghiá»‡p tá»« **"xÃ¢y má»›i hoÃ n toÃ n"** thÃ nh **"táº­n dá»¥ng thÃ´ng minh"**.

Káº¿t quáº£:
- âœ… Tiáº¿t kiá»‡m chi phÃ­ 10-20%
- âœ… Nhanh hÆ¡n 2-3 thÃ¡ng
- âœ… ThÃ¢n thiá»‡n mÃ´i trÆ°á»ng
- âœ… KhÃ¡ch hÃ ng hÃ i lÃ²ng hÆ¡n

**ÄÃ¢y lÃ  lá»£i tháº¿ cáº¡nh tranh lá»›n so vá»›i cÃ¡c cÃ´ng ty thiáº¿t káº¿ truyá»n thá»‘ng!**
